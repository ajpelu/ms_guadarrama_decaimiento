[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Temporal analysis of IV",
    "section": "",
    "text": "This repository contains analysis of the spectral indices obtanied from Remote sensing of several stands forest at Guadarrama National Park."
  },
  {
    "objectID": "iv_temporal_series.html",
    "href": "iv_temporal_series.html",
    "title": "Temporal analysis of IV",
    "section": "",
    "text": "To explore the temporal evolution of several spectral indices for forest stands with tree mortality comparing with control forest stands.\nTwo species: Pinus sylvestris and P. pinaster\nTwo sites; Valdemaqueda (pinaster) and Valsaín (sylvestris)\nSpectral product used:\n\nLandsat: several collections. We used the harmonized product. Spatial resolution = 30 m; temporal range: 1985-2023; temporal resolution = varies according to product used. More info.\nSentinel2: spatial resolution = 10-20 m; temporal range: 2017-2023; temporal resolution = 25 days\nMODIS MOD13Q1: spatial resolution = 250 m; temporal range: 2000-2023; temporal resolution = 23 days"
  },
  {
    "objectID": "iv_temporal_series.html#aims",
    "href": "iv_temporal_series.html#aims",
    "title": "Temporal analysis of IV",
    "section": "",
    "text": "To explore the temporal evolution of several spectral indices for forest stands with tree mortality comparing with control forest stands.\nTwo species: Pinus sylvestris and P. pinaster\nTwo sites; Valdemaqueda (pinaster) and Valsaín (sylvestris)\nSpectral product used:\n\nLandsat: several collections. We used the harmonized product. Spatial resolution = 30 m; temporal range: 1985-2023; temporal resolution = varies according to product used. More info.\nSentinel2: spatial resolution = 10-20 m; temporal range: 2017-2023; temporal resolution = 25 days\nMODIS MOD13Q1: spatial resolution = 250 m; temporal range: 2000-2023; temporal resolution = 23 days"
  },
  {
    "objectID": "iv_temporal_series.html#prepare-data",
    "href": "iv_temporal_series.html#prepare-data",
    "title": "Temporal analysis of IV",
    "section": "Prepare Data",
    "text": "Prepare Data\n\nAll the data were obtained using GEE\nWe applied several filters to remove low quality data (avoid clouds, etc)\n\n\nlibrary(tidyverse)\noptions(tidyverse.quiet = TRUE)\n\n\nraw_landsat &lt;- read_csv(\"data/raw/guadarrama_pinaster_syl_landsat_c02.csv\")\nraw_modis &lt;- read_csv(\"data/raw/guadarrama_pinaster_syl_modis_mod13q1.csv\")\npixel_id &lt;- read_csv(\"data/geoinfo/pixel_idtree.csv\")"
  },
  {
    "objectID": "iv_temporal_series.html#landsat",
    "href": "iv_temporal_series.html#landsat",
    "title": "Temporal analysis of IV",
    "section": "Landsat",
    "text": "Landsat\n\nraw_landsat &lt;- read_csv(\"data/raw/guadarrama_pinaster_syl_landsat_c02.csv\") |&gt; \n  rename(evi = EVI, ndvi = NDVI) |&gt;\n  mutate(date = as.Date(as.character(date), format=\"%Y%m%d\")) |&gt; \n  mutate(date = as.Date(date, format = \"%Y%m%d\")) |&gt; \n  dplyr::select(evi, ndvi, date, sp, status, name) |&gt; \n  mutate(year = lubridate::year(date), \n         month = lubridate::month(date)) \n\n\nEVI\n\nlandsat_evi &lt;- raw_landsat |&gt; \n  dplyr::select(-ndvi) |&gt; \n  filter(!is.na(evi)) |&gt; \n  rename(value=evi) |&gt; \n  mutate(iv=\"evi\")\n\nlandsat_evi_id &lt;- landsat_evi |&gt; inner_join(pixel_id) |&gt; dplyr::select(-name, -pixel_sentinel, -pixel_modis)  \n\n\n  \nlandsat_evi_yearly &lt;- landsat_evi_id |&gt; \n  group_by(sp, status, year) |&gt; \n    summarise(mean = mean(value, na.rm = TRUE), \n            sd = sd(value, na.rm = TRUE), \n            se = sd/sqrt(length(value)),\n            n = length(value))\n\n\ncolores_status &lt;-  c(\"Decaimiento\" = \"red\", \n                     \"Sanos\" =\"blue\")\n\n\nlandsat_evi_yearly |&gt; \n  ggplot(aes(x = year, y = mean, fill=status, colour=status)) +\n  geom_line() +  \n  geom_ribbon(data=landsat_evi_yearly, \n              aes(ymin = (mean - se), ymax=(mean+se)), colour=NA, alpha=.2) +\n  theme_bw() +\n  facet_wrap(~sp, ncol = 1) + \n  scale_x_continuous(limits = c(1986, 2023), breaks = seq(1986,2023, by=4)) +\n  theme(\n    panel.grid = element_blank(), \n    strip.text = element_text(face = \"italic\"),\n    strip.background = element_rect(fill = \"white\"),\n    legend.position = \"bottom\"\n  ) + \n  ylab(\"Annual EVI (Landsat)\") +\n  scale_fill_manual(values = colores_status)\n\n\n\n\n\n\n\n\n\n\nNDVI\n\nlandsat_ndvi &lt;- raw_landsat |&gt; \n  dplyr::select(-evi) |&gt; \n  filter(!is.na(ndvi)) |&gt; \n  rename(value=ndvi) |&gt; \n  mutate(iv=\"ndvi\")\n\nlandsat_ndvi_id &lt;- landsat_ndvi |&gt; inner_join(pixel_id) |&gt; dplyr::select(-name, -pixel_sentinel, -pixel_modis)  \n\nlandsat_ndvi_yearly &lt;- landsat_ndvi_id |&gt; \n  group_by(sp, status, year) |&gt; \n    summarise(mean = mean(value, na.rm = TRUE), \n            sd = sd(value, na.rm = TRUE), \n            se = sd/sqrt(length(value)),\n            n = length(value))\n\n\nlandsat_ndvi_yearly |&gt; \n  ggplot(aes(x = year, y = mean, fill=status, colour=status)) +\n  geom_line() +  \n  geom_ribbon(aes(ymin = (mean - se), ymax=(mean+se)), colour=NA, alpha=.2) +\n  theme_bw() +\n  facet_wrap(~sp, ncol = 1) + \n  scale_x_continuous(limits = c(1986, 2023), breaks = seq(1986,2023, by=4)) +\n  theme(\n    panel.grid = element_blank(), \n    strip.text = element_text(face = \"italic\"),\n    strip.background = element_rect(fill = \"white\"),\n    legend.position = \"bottom\"\n  ) + \n  ylab(\"Annual NDVI (Landsat)\") +\n  scale_fill_manual(values = colores_status)\n\n\n\n\n\n\n\n\n\n\nSentinel\n\nsee this paper for some indexes used\n\n\nraw_sentinel &lt;- read_csv(\"data/raw/guadarrama_pinaster_syl_sentinel_harmonized.csv\") |&gt; \n  mutate(date = as.Date(as.character(substr(`system:index`, 1,8)), format=\"%Y%m%d\")) |&gt; \n  mutate(year = lubridate::year(date), \n         month = lubridate::month(date)) |&gt; \n  dplyr::select(-`system:index`,-`.geo`, -ele, -numero, -tipo) |&gt; \n  filter(!is.na(EVI)) |&gt; \n  janitor::clean_names()\n  \n\nsentinel &lt;- raw_sentinel |&gt; \n  pivot_longer(evi:vig,  names_to = \"iv\", values_to = \"value\") \n\nsentinel_date &lt;-\n  sentinel |&gt; \n  filter(date &gt; as.Date(\"2017-06-01\")) |&gt; \n  mutate(date2 = as.Date(paste0(format(date, \"%Y-%m\"), \"-01\"), format = \"%Y-%m-%d\")) |&gt; \n  group_by(sp, status, date2, iv) |&gt; \n  summarise(mean = mean(value, na.rm = TRUE), \n            sd = sd(value, na.rm = TRUE), \n            se = sd/sqrt(length(value)),\n            n = length(value)) |&gt; \n  ungroup()\n\n\nNDVI\n\nsentinel_date |&gt; \n  # filter(iv %in% c('savi','evi','ndvi','nbr')) |&gt; \n  filter(iv == \"ndvi\") |&gt; \n  ggplot(aes(x = date2, y = mean, fill=status, colour=status, group = status)) +\n  geom_line() +  \n  geom_ribbon(aes(ymin = (mean - se), ymax=(mean+se)), colour=NA, alpha=.2) +\n  theme_bw() +\n  facet_wrap(~sp, ncol=1) + theme(\n    panel.grid = element_blank(), \n    strip.text = element_text(face = \"italic\"),\n    strip.background = element_rect(fill = \"white\"),\n    legend.position = \"bottom\"\n  ) + \n  ylab(\"NDVI (Sentinel)\") +\n  scale_fill_manual(values = colores_status) +\n  scale_x_date(date_breaks = \"6 months\", date_labels = \"%Y-%m\") +\n  xlab(\"Date\")\n\n\n\n\n\n\n\n\n\n\nEVI\n\nsentinel_date |&gt; \n  # filter(iv %in% c('savi','evi','ndvi','nbr')) |&gt; \n  filter(iv == \"evi\") |&gt; \n  ggplot(aes(x = date2, y = mean, fill=status, colour=status, group = status)) +\n  geom_line() +  \n  geom_ribbon(aes(ymin = (mean - se), ymax=(mean+se)), colour=NA, alpha=.2) +\n  theme_bw() +\n  facet_wrap(~sp, ncol=1) + theme(\n    panel.grid = element_blank(), \n    strip.text = element_text(face = \"italic\"),\n    strip.background = element_rect(fill = \"white\"),\n    legend.position = \"bottom\"\n  ) + \n  ylab(\"EVI (Sentinel)\") +\n  scale_fill_manual(values = colores_status) + \n  scale_x_date(date_breaks = \"6 months\", date_labels = \"%Y-%m\") +\n  xlab(\"Date\")\n\n\n\n\n\n\n\n\n\n\nSAVI\n\nsentinel_date |&gt; \n  # filter(iv %in% c('savi','evi','ndvi','nbr')) |&gt; \n  filter(iv == \"savi\") |&gt; \n  ggplot(aes(x = date2, y = mean, fill=status, colour=status, group = status)) +\n  geom_line() +  \n  geom_ribbon(aes(ymin = (mean - se), ymax=(mean+se)), colour=NA, alpha=.2) +\n  theme_bw() +\n  facet_wrap(~sp, ncol=1) + theme(\n    panel.grid = element_blank(), \n    strip.text = element_text(face = \"italic\"),\n    strip.background = element_rect(fill = \"white\"),\n    legend.position = \"bottom\"\n  ) + \n  ylab(\"Soil Adjusted Vegetation Index (Sentinel)\") +\n  scale_fill_manual(values = colores_status) + \n  scale_x_date(date_breaks = \"6 months\", date_labels = \"%Y-%m\") +\n  xlab(\"Date\")\n\n\n\n\n\n\n\n\n\n\nNBR\n\nsentinel_date |&gt; \n  # filter(iv %in% c('savi','evi','ndvi','nbr')) |&gt; \n  filter(iv == \"nbr\") |&gt; \n  ggplot(aes(x = date2, y = mean, fill=status, colour=status, group = status)) +\n  geom_line() +  \n  geom_ribbon(aes(ymin = (mean - se), ymax=(mean+se)), colour=NA, alpha=.2) +\n  theme_bw() +\n  facet_wrap(~sp, ncol=1) + theme(\n    panel.grid = element_blank(), \n    strip.text = element_text(face = \"italic\"),\n    strip.background = element_rect(fill = \"white\"),\n    legend.position = \"bottom\"\n  ) + \n  ylab(\"NBR (Sentinel)\") +\n  scale_fill_manual(values = colores_status) + \n  scale_x_date(date_breaks = \"6 months\", date_labels = \"%Y-%m\") +\n  xlab(\"Date\")"
  },
  {
    "objectID": "iv_temporal_series.html#modis",
    "href": "iv_temporal_series.html#modis",
    "title": "Temporal analysis of IV",
    "section": "MODIS",
    "text": "MODIS\n\nmodis &lt;- raw_modis |&gt;\n  mutate(date = as.Date(str_replace_all(substr(`system:index`, 1, 10), \"_\", \"-\"),\n                        format = \"%Y-%m-%d\"),\n         evi = EVI*0.0001,\n         ndvi = NDVI*0.0001) |&gt; \n  dplyr::select(sp, status, date, evi, ndvi) |&gt; \n  unique() \n\n\ndf_modis &lt;- modis |&gt; \n  pivot_longer(evi:ndvi, \n               names_to = \"iv\", \n               values_to = \"value\")\n\ndf_modis_date &lt;- df_modis |&gt; \n  mutate(year = lubridate::year(date)) |&gt; \n  group_by(sp, status, year, iv) |&gt; \n  summarise(mean = mean(value, na.rm = TRUE), \n            sd = sd(value, na.rm = TRUE), \n            se = sd/sqrt(length(value)),\n            cv = sd/mean*100,\n            n = length(value))\n\n\ncolores_status &lt;-  c(\"Decaimiento\" = \"red\", \n                     \"Sanos\" =\"blue\")\n\n\ndf_modis_date |&gt; \n  filter(iv == \"evi\") |&gt; \n  ggplot(aes(x=year, y=mean, fill=status, colour=status, group=status)) +\n  geom_ribbon(aes(ymin = (mean - se), ymax=(mean+se)), colour=NA, alpha=.2) + \n  geom_point() + \n  geom_line() + \n  facet_wrap(~sp, ncol = 1) +\n  theme_bw() +\n    theme(\n    panel.grid = element_blank(), \n    strip.text = element_text(face = \"italic\"),\n    strip.background = element_rect(fill = \"white\"),\n    legend.position = \"bottom\"\n  ) +\n  ylab(\"Annual EVI (MODIS)\") +\n  scale_fill_manual(values = colores_status) +\n  scale_colour_manual(values = colores_status)\n\n\n\n\n\n\n\n\n\ndf_modis_date |&gt; \n  filter(iv == \"ndvi\") |&gt; \n  ggplot(aes(x=year, y=mean, fill=status, colour=status, group=status)) +\n  geom_ribbon(aes(ymin = (mean - se), ymax=(mean+se)), colour=NA, alpha=.2) + \n  geom_point() + \n  geom_line() + \n  facet_wrap(~sp, ncol = 1) +\n  theme_bw() +\n    theme(\n    panel.grid = element_blank(), \n    strip.text = element_text(face = \"italic\"),\n    strip.background = element_rect(fill = \"white\"),\n    legend.position = \"bottom\"\n  ) +\n  ylab(\"Annual NDVI (MODIS)\") +\n  scale_fill_manual(values = colores_status) +\n  scale_colour_manual(values = colores_status)"
  }
]